# Production docker-compose
# Replace YOUR_USERNAME with your GitHub username
# Deploy with: docker-compose -f docker-compose.prod.yml up -d

services:
  api:
    image: ghcr.io/YOUR_USERNAME/qbcommerce-api:latest
    container_name: qbcommerce-api
    environment:
      - ASPNETCORE_ENVIRONMENT=Production
      - ASPNETCORE_URLS=http://+:8080
      - ConnectionStrings__DefaultConnectionString=Host=host.docker.internal;Database=qbcommercedb;Username=qbcommerce;Password=${DB_PASSWORD}
      - AdminUser__Email=${ADMIN_EMAIL}
      - AdminUser__Password=${ADMIN_PASSWORD}
    extra_hosts:
      - "host.docker.internal:host-gateway"
    restart: unless-stopped
    networks:
      - qbcommerce-network

  blazor:
    image: ghcr.io/YOUR_USERNAME/qbcommerce-blazor:latest
    container_name: qbcommerce-blazor
    environment:
      - ASPNETCORE_ENVIRONMENT=Production
      - ASPNETCORE_URLS=http://+:8080
      - ApiSettings__BaseAddress=http://api:8080
    depends_on:
      - api
    restart: unless-stopped
    networks:
      - qbcommerce-network

  nginx-proxy-manager:
    image: jc21/nginx-proxy-manager:latest
    container_name: nginx-proxy-manager
    ports:
      - "80:80"
      - "443:443"
      - "81:81"
    volumes:
      - ./npm-data:/data
      - ./npm-letsencrypt:/etc/letsencrypt
    restart: unless-stopped
    networks:
      - qbcommerce-network

networks:
  qbcommerce-network:
    driver: bridge
